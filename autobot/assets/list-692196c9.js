import{a as K,aL as ge,i as p,c as E,l as ve,a1 as ye,o as z,e as D,x as a,v as l,af as u,Q as O,az as we,s as be,ag as i,N as o,n as B,f as F,bZ as Ce,b_ as $e,b$ as ke,c0 as Fe,a$ as g,aX as v,bx as ze,C as je,c1 as Ee,D as De}from"./index-80c046a1.js";import{E as qe}from"./el-progress-41a3fe35.js";import{E as Ue,a as Pe}from"./el-table-column-50584081.js";/* empty css                    *//* empty css                   */import"./el-scrollbar-8a15482a.js";/* empty css               *//* empty css                        *//* empty css                   */import{E as Ve}from"./el-card-70d75a6f.js";import{a as Be,E as Le}from"./el-breadcrumb-item-88ae363b.js";import{d as Ie,f as Re}from"./index-d95d03df.js";import{b as Ne}from"./index-34f0d031.js";import{d as Se}from"./BaseUtils-6104fabf.js";import{h as xe}from"./index-abe5989c.js";import{_ as Te}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-1611a53e.js";import"./index-7b8336c4.js";import"./isUndefined-aa0326a0.js";import"./debounce-75874e58.js";import"./index-2bee3e67.js";import"./raf-f330aa78.js";const Ae={class:"file_main"},Oe={class:"file_main_head"},Ke={style:{margin:"0","text-align":"right"}},Me={style:{margin:"0","text-align":"right"}},Ye={style:{margin:"0","text-align":"right"}},Ge={class:"file_main_body"},We={class:"file_main_left"},Ze=["onClick"],Qe={key:1,class:"file_item_name_icon iconfont icon-wenjianjia-copy-copy"},Xe={style:{margin:"0","text-align":"right"}},He={style:{margin:"0","text-align":"right"}},Je={class:"file_main_right"},ea={class:"el-upload__text"},aa={class:"el-upload__tip"},la={class:"file_upload_clear"},na=K({__name:"index",setup(M){const{device:t}=ge(),r=p("/sdcard"),q=p([]),U=p(""),w=p(""),b=p([]),Y=E(()=>r.value.startsWith("/sdcard/")?{path:r.value}:{path:"/sdcard/"}),G=E(()=>{const e=r.value.split("/").slice(1).filter(Boolean);return e.length>0?e.map((c,h)=>{let m=e.slice(0,h+1).join("/");return{name:c,path:"/"+m}}):[]}),L=E(()=>b.value.length>0);function R(e){r.value=e}ve(r,function(e,s){e&&f()},{immediate:!0});async function f(){const e=await(t==null?void 0:t.listFile(r.value)),s=e?[...e]:[],c=s.filter(m=>!m.isFile).sort((m,y)=>m.name<y.name?-1:1),h=s.filter(m=>m.isFile).sort((m,y)=>m.name<y.name?-1:1);q.value=c.concat(h)}ye(()=>{W(),f()});const N=p("");function W(){const e=t==null?void 0:t.uploadUrl();N.value=e}function Z(e){console.log("newFiles",e),b.value=e}function Q(e){console.log(e),r.value=e.path}function X(e){const s=t==null?void 0:t.downloadUrl(e.path);Ne(s)}function H(e){w.value=e.name}async function J(e){if(w.value==e.name)return;if(w.value.includes(" ")){g(v("wen-jian-ming-bu-neng-bao-han-kong-ge"));return}let s=`${r.value}/${w.value}`;await(t==null?void 0:t.execCmd(`mv '${e.path}' '${s}'`)),f(),g(v("xiu-gai-cheng-gong"))}function oa(e){}async function ee(e){await(t==null?void 0:t.delFile(e.path)),f(),g(v("shan-chu-cheng-gong"))}function ae(){U.value=""}async function le(){let e=`${r.value}/${U.value}`;await(t==null?void 0:t.execCmd(`mkdir -p ${e}`)),f(),g(v("xin-jian-cheng-gong"))}const S=p(!1);function ne(){S.value=!0}async function te(){const e=b.value;for(let s of e)try{await(t==null?void 0:t.delFile(s.path))}catch(c){console.log(c)}f(),S.value=!1,g(v("shan-chu-cheng-gong"))}const P=p("archive");p(!1);async function ie(){P.value="archive-"+parseInt(Math.random()*1e3+"")}async function oe(){g(v("zheng-zai-chuang-jian-ya-suo-wen-jian"));const e=b.value,s=r.value,c=P.value;let h=e.map(m=>`'${m.name}'`).join(" ");await(t==null?void 0:t.execCmd(`tar -czvf ${s}/${c}.tar.gz -C ${s} ${h}`,20)),f(),g(v("chuang-jian-cheng-gong"))}const se=Se(f,1e3);function ue(){se()}const x=p();function re(){var e;(e=x.value)==null||e.clearFiles()}const V=p(""),C=p(0),$=p([]),T=E(()=>L.value&&C.value==0);function de(){V.value=r.value,$.value=[...b.value],C.value=1}function ce(){V.value=r.value,$.value=[...b.value],C.value=2}const me=E(()=>{let e=$.value.some(s=>s.path==r.value||!s.path.replace(r.value,""));return $.value.length>0&&V.value!=r.value&&!e});async function pe(){const e=r.value,s=$.value;if(C.value==1)for(let c of s)try{await(t==null?void 0:t.execCmd(`cp -r '${c.path}' '${e}'`,20))}catch{}else if(C.value==2)for(let c of s)await(t==null?void 0:t.execCmd(`mv '${c.path}' '${e}'`,20));g(v("cao-zuo-cheng-gong")),f(),A()}function A(){$.value=[],V.value="",C.value=0}return(e,s)=>{const c=Be,h=Le,m=Ve,y=ze,d=je,j=xe,I=Ee,k=Ue,fe=Pe,_e=De,he=qe;return z(),D(O,null,[a(m,null,{default:l(()=>[a(h,{separator:"/"},{default:l(()=>[a(c,{onClick:s[0]||(s[0]=n=>R("/"))},{default:l(()=>[u("root")]),_:1}),(z(!0),D(O,null,we(G.value,(n,_)=>(z(),be(c,{key:_,onClick:sa=>R(n.path)},{default:l(()=>[u(i(n.name),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),a(m,{class:"mt-20px"},{default:l(()=>[o("div",Ae,[o("div",Oe,[a(j,{placement:"bottom-start",trigger:"click",width:200},{reference:l(()=>[a(d,{type:"success",onClick:ae},{default:l(()=>[u(i(e.$t("xin-jian-wen-jian-jia")),1)]),_:1})]),default:l(()=>[o("p",null,i(e.$t("qing-shu-ru-wen-jian-jia-ming-cheng")),1),o("p",null,[a(y,{modelValue:U.value,"onUpdate:modelValue":s[1]||(s[1]=n=>U.value=n),autofocus:""},null,8,["modelValue"])]),o("div",Ke,[a(d,{size:"small",type:"primary",onClick:le},{default:l(()=>[u(i(e.$t("que-ding")),1)]),_:1})])]),_:1}),a(I,{class:"ml-4"},{default:l(()=>[a(d,{type:"primary",onClick:f},{default:l(()=>[u(i(e.$t("shua-xin")),1)]),_:1})]),_:1}),a(I,{class:"ml-4"},{default:l(()=>[a(j,{width:"200",placement:"top",trigger:"click"},{reference:l(()=>[a(d,{type:"primary",disabled:!L.value,onClick:ie},{default:l(()=>[u(i(e.$t("chuang-jian-ya-suo-wen-jian")),1)]),_:1},8,["disabled"])]),default:l(()=>[o("p",null,i(e.$t("qing-shu-ru-wen-jian-ming-cheng")),1),o("p",null,[a(y,{modelValue:P.value,"onUpdate:modelValue":s[2]||(s[2]=n=>P.value=n),autofocus:""},{append:l(()=>[u(".tar.gz")]),_:1},8,["modelValue"])]),o("div",Me,[a(d,{size:"small",type:"primary",onClick:oe},{default:l(()=>[u(i(e.$t("que-ding")),1)]),_:1})])]),_:1}),a(j,{placement:"top",trigger:"click"},{reference:l(()=>[a(d,{type:"danger",disabled:!L.value,onClick:ne},{default:l(()=>[u(i(e.$t("shan-chu")),1)]),_:1},8,["disabled"])]),default:l(()=>[o("p",null,i(e.$t("que-ding-shan-chu-ma")),1),o("div",Ye,[a(d,{size:"small",type:"primary",onClick:te},{default:l(()=>[u(i(e.$t("que-ding")),1)]),_:1})])]),_:1})]),_:1}),a(I,{class:"ml-4"},{default:l(()=>[a(d,{type:"primary",disabled:!T.value,onClick:de},{default:l(()=>[u(i(e.$t("fu-zhi")),1)]),_:1},8,["disabled"]),a(d,{type:"primary",disabled:!T.value,onClick:ce},{default:l(()=>[u(i(e.$t("jian-qie")),1)]),_:1},8,["disabled"]),a(d,{type:"success",disabled:!me.value,onClick:pe},{default:l(()=>[u(i(e.$t("nian-tie")),1)]),_:1},8,["disabled"]),a(d,{type:"danger",onClick:A},{default:l(()=>[u(i(e.$t("qu-xiao")),1)]),_:1})]),_:1})]),o("div",Ge,[o("div",We,[a(fe,{data:q.value,height:"700px",onSelectionChange:Z},{default:l(()=>[a(k,{type:"selection",width:"55"}),a(k,{prop:"name",sortable:"",label:e.$t("wen-jian-ming"),width:"300"},{default:l(n=>[o("span",{class:B(["file_item_name",{disabled:!n.row.isRead}]),onClick:_=>Q(n.row)},[n.row.isFile?(z(),D("span",{key:0,class:B(["file_item_name_icon iconfont icon-doc-line",{isfile:n.row.isFile}])},null,2)):(z(),D("span",Qe)),u(" "+i(n.row.name),1)],10,Ze)]),_:1},8,["label"]),a(k,{width:"100",label:e.$t("du-xie")},{default:l(n=>[o("span",{class:B(["file_item_rw",{isY:n.row.isRead}])},i(n.row.isRead?"Y":"N"),3),u("/ "),o("span",{class:B(["file_item_rw",{isY:n.row.isRead}])},i(n.row.isRead?"Y":"N"),3)]),_:1},8,["label"]),a(k,{prop:"lastModified",sortable:"",width:"180",label:e.$t("zui-hou-xiu-gai-shi-jian")},{default:l(n=>[u(i(F(Ie)(n.row.lastModified)),1)]),_:1},8,["label"]),a(k,{prop:"size",sortable:"",label:e.$t("da-xiao"),width:"120"},{default:l(n=>[u(i(n.row.size?F(Re)(n.row.size):"--"),1)]),_:1},8,["label"]),a(k,{label:e.$t("cao-zuo"),width:"160"},{default:l(n=>[a(d,{disabled:!n.row.isFile,link:"",type:"primary",size:"small",icon:F(Ce),onClick:_=>X(n.row)},null,8,["disabled","icon","onClick"]),a(j,{placement:"top",trigger:"click"},{reference:l(()=>[a(d,{disabled:!n.row.isWrite,link:"",type:"warning",size:"small",icon:F($e),onClick:_=>H(n.row)},null,8,["disabled","icon","onClick"])]),default:l(()=>[o("p",null,i(e.$t("qing-shu-ru-xin-de-ming-cheng")),1),o("p",null,[a(y,{modelValue:w.value,"onUpdate:modelValue":s[3]||(s[3]=_=>w.value=_),autofocus:""},null,8,["modelValue"])]),o("div",Xe,[a(d,{size:"small",type:"primary",onClick:_=>J(n.row)},{default:l(()=>[u(i(e.$t("que-ding")),1)]),_:2},1032,["onClick"])])]),_:2},1024),a(j,{placement:"top",trigger:"click"},{reference:l(()=>[a(d,{disabled:!n.row.isWrite,link:"",type:"danger",size:"small",icon:F(ke),onClick:_=>(n.row,void 0)},null,8,["disabled","icon","onClick"])]),default:l(()=>[o("p",null,i(e.$t("que-ding-shan-chu-ma")),1),o("div",He,[a(d,{size:"small",type:"primary",onClick:_=>ee(n.row)},{default:l(()=>[u(i(e.$t("que-ding")),1)]),_:2},1032,["onClick"])])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])]),o("div",Je,[a(he,{ref_key:"Upload",ref:x,class:"file_upload",drag:"",action:N.value,multiple:"",data:Y.value,"on-success":ue},{tip:l(()=>[o("div",aa,[o("dl",null,[o("dt",null,i(e.$t("zhu-yi-shi-xiang")),1),o("dd",null,i(e.$t("shangchuan_zhuyi_1")),1),o("dd",null,i(e.$t("shangchuan_zhuyi_2")),1)])]),o("div",la,[a(d,{type:"primary",text:"",onClick:re},{default:l(()=>[u(i(e.$t("qing-chu-yi-wan-cheng")),1)]),_:1})])]),default:l(()=>[a(_e,{class:"el-icon--upload"},{default:l(()=>[a(F(Fe))]),_:1}),o("div",ea,[u(i(e.$t("tuo-dong-wen-jian-dao-zhe-li-huo"))+" ",1),o("em",null,i(e.$t("dian-ji-shang-chuan")),1)])]),_:1},8,["action","data"])])])])]),_:1})],64)}}});const ta=Te(na,[["__scopeId","data-v-6b41e6fc"]]),ia={class:"app-container"},qa=K({name:"FileList",inheritAttrs:!1,__name:"list",setup(M){return(t,r)=>{const q=ta;return z(),D("div",ia,[a(q)])}}});export{qa as default};
